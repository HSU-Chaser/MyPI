<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR">
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">

<META Name="InChm" Content="True">

<SCRIPT LANGUAGE="JavaScript">
var page_title= "Using Swiff Chart Generator with ColdFusion";
var page_title_ID= "ugUsingInCF";
</SCRIPT>

<SCRIPT SRC="../scripts/dtuelink2.js"></SCRIPT>
<SCRIPT SRC="../scripts/main.js"></SCRIPT>

</HEAD>

<body topmargin=0 id="bodyID" class = "dtBODY">

<SCRIPT LANGUAGE="JavaScript">
write_header(page_title,page_title_ID,"ColdFusion");
</SCRIPT>


<DIV id="scrtext" valign="bottom">

<br>

<p>Swiff Chart Generator is implemented as a <b>COM object</b> and offers a 
variety of methods for managing and creating charts in Flash. Since ColdFusion supports COM objects, 
running Swiff Chart Generator within ColdFusion is very simple.</p>
<br>

<p>To insert a chart in a ColdFusion page you must either use the 
<font STYLE="font-family: Monospace, Courier New, Courier;">CFOBJECT</font> tag or call the 
<font STYLE="font-family: Monospace, Courier New, Courier;">CreateObject</font> function. 
By using one of these two methods, you will create an instance of the Swiff Chart Generator COM object
and have full access to its API (Refer to Swiff Chart Generator documentation for complete description of the API).
</p>
<br>


<br>
<p><b>How does Swiff Chart Generator work within ColdFusion?</b></p>
<br>

<p>Two pages are required to dynamically generate a chart.</p>
<br>
<ul>
  <li>The first page is a ColdFusion page that generates and outputs 
a Flash movie containing your chart through the 
<font STYLE="font-family: Monospace, Courier New, Courier;">&lt;CFCONTENT&gt;</font> ColdFusion tag. 

  <li>The second page is the one where you 
want to display your chart. It can be an HTML page or a CFM generated page and it includes the Flash Player through               the <font STYLE="font-family: Monospace, Courier New, Courier;">&lt;OBJECT&gt;</font> HTML tag. 
The idea is to simply set the <i>movie</i> parameter of the 
Flash Player Object to the ColdFusion filename:
</ul>
</font>

<pre class=code>
&lt;OBJECT CLASSID="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
        WIDTH="400" 
        HEIGHT="300"&gt;
   &lt;PARAM NAME=movie VALUE="gen_chart.cfm"&gt;
&lt;OBJECT/&gt;
</pre>

<font class="BodyStyle">
<br>
<p><b>A simple ColdFusion Example</b></p>
<br>

<p>The following example illustrates how simple it is to dynamically generate charts in Flash in ColdFusion. 
As mentioned in the previous paragraph, the example involves 2 files and an additional Swiff Chart style file 
(.scs):</p>
<br>
<UL>
  <LI><a href="#gen_chart.cfm">gen_chart.cfm</a> - <i>ColdFusion file for generating the chart </i></LI>
  <LI><a href="#chart.html">chart.html</a> - <i>HTML file for displaying the chart</i></LI>
  <LI>chart_style.scs - <i>Swiff Chart Style file for setting the chart layout</i></LI>
</UL>

<br>
<p>To install and run the example, simply download and copy these 3 files on your 
Web site in the same directory.
</p>


<a name=#gen_chart.cfm></a>
<br>
<p><b>ColdFusion file: gen_chart.cfm</b></font></p>

<pre class=code>
    <font color=#770000>&lt;CFSETTING ENABLECFOUTPUTONLY</font>="Yes" <font color=#770000>SHOWDEBUGOUTPUT=</font>"No"<font color=#770000>&gt;</font>

    <font color=#770000>&lt;CFOBJECT TYPE=</font>"COM" 
              <font color=#770000>NAME=</font>"chart" 
              <font color=#770000>CLASS=</font>"SwiffChartObject.ChartObj" 
              <font color=#770000>ACTION=</font>"CREATE"<font color=#770000><font color=#770000>&gt;</font></font>

    <font color=#007700>&lt;!--- Define seperators rules ---&gt;</font>
    <font color=#770000>&lt;CFSET</font> sep= ";"<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> ignoremultseparators= true<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.SetSeparators(sep, ignoremultseparators)<font color=#770000>&gt;</font>

    <font color=#007700>&lt;!--- Set the heading for the graph ---&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.SetTitle("My Chart")<font color=#770000>&gt;</font>

    <font color=#007700>&lt;!--- Create the categories ---&gt;</font>
    <font color=#770000>&lt;CFSET</font> myCategories= "Q1" & sep & "Q2" & sep & "Q3"<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.SetCategoriesFromString(myCategories)<font color=#770000>&gt;</font>

    <font color=#007700>&lt;!--- Create a string for each series ---&gt;</font>
    <font color=#770000>&lt;CFSET</font> series1= "1.2" & sep & "3.5" & sep & "11.3"<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> series2= "2.3" & sep & "4.5" & sep &  "9.3"<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> series3= "3.2" & sep & "5.5" & sep & "14.3"<font color=#770000>&gt;</font>

    <font color=#007700>&lt;!--- Fill the chart with the series ---&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.SetSeriesCaption(0, "First Series")<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.SetSeriesValuesFromString(0, series1)<font color=#770000>&gt;</font>

    <font color=#770000>&lt;CFSET</font> chart.SetSeriesCaption(1, "Second Series")<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.SetSeriesValuesFromString(1, series2)<font color=#770000>&gt;</font>

    <font color=#770000>&lt;CFSET</font> chart.SetSeriesCaption(2, "Third Series")<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.SetSeriesValuesFromString(2, series3)<font color=#770000>&gt;</font>

    <font color=#007700>&lt;!--- Define path to style document ---&gt;</font>
    <font color=#770000>&lt;CFSET</font> dirpath = GetDirectoryFromPath( GetBaseTemplatePath() )<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> style = dirpath & "chart_style.scs"<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.LoadStyle( style )<font color=#770000>&gt;</font>

    <font color=#007700>&lt;!--- Set the dimensions of the movie ---&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.SetWidth( 400 )<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.SetHeight( 300 )<font color=#770000>&gt;</font>

    <font color=#770000>&lt;CFSET</font> account_id = "100"<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> filename=  dirpath 
                    & "graph" 
                    & dateformat(now(), "DDMMYY") 
                    & "_" & timeformat(now(), "HHMMSS") 
                    & "_" & account_id & ".swf"<font color=#770000>&gt;</font>
    <font color=#770000>&lt;CFSET</font> chart.ExportAsFile(filename)<font color=#770000>&gt;</font>

    <font color=#770000>&lt;CFCONTENT TYPE=</font>"application/x-shockwave-flash" 
               <font color=#770000>FILE=</font>"#filename#"<font color=#770000>&gt;</font>
</pre>


<a name=#chart.html></a>
<br>
<p><font class="BodyStyle"><b>HTML file: chart.html</b></font></p>

<pre class=code>
    &lt;HTML&gt;
    &lt;HEAD&gt;
    &lt;TITLE&gt;Swiff Chart Generator - ColdFusion Sample&lt;/TITLE&gt;
    &lt;/HEAD&gt;

    &lt;BODY BGCOLOR="#FFFFFF" TEXT="#000000"&gt;

    &lt;OBJECT CLASSID="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" 
            CODEBASE="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" 
            WIDTH="400" 
            HEIGHT="300"&gt;
      &lt;PARAM NAME=movie VALUE="gen_chart.cfm"&gt;
      &lt;PARAM NAME=quality VALUE=high&gt;
      &lt;EMBED SRC="gen_chart.cfm" 
             QUALITY=high 
             PLUGINSPAGE="http://www.adobe.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" 
             TYPE="application/x-shockwave-flash" 
             WIDTH="400" 
             HEIGHT="300"&gt;
      &lt;/EMBED&gt; 
    &lt;/OBJECT&gt;

    &lt;/BODY&gt;
    &lt;/HTML&gt;</pre>

<a name=#result></a>
<br>
<p><font class="BodyStyle"><b>What you will obtain</b></font></p>
<img src="../images/result.jpg">



<SCRIPT LANGUAGE="JavaScript">
write_footer();
</SCRIPT>

</BODY>
</HTML>
