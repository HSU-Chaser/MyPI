<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR">
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">

<META Name="InChm" Content="True">

<SCRIPT LANGUAGE="JavaScript">
var page_title= "SetDataFromTxtFile Method";
var page_title_ID= "fcomthsetdatafromtxtfile";
var page_lang= "VBScript";
</SCRIPT>

<SCRIPT SRC="../scripts/dtuelink2.js"></SCRIPT>
<SCRIPT SRC="../scripts/main.js"></SCRIPT>

</HEAD>

<body topmargin=0 id="bodyID" class = "dtBODY">

<SCRIPT LANGUAGE="JavaScript">
write_header(page_title,page_title_ID,page_lang);
</SCRIPT>

<DIV id="scrtext" valign="bottom">

<!-- Main Definition -->
<P>Specifies the data (i.e. title, series values & captions, categories, etc) directly from a text file.</P>

<!-- Profile -->
<PRE class="syntax">object<B>.SetDataFromTxtFile</B>&nbsp;filename,&nbsp;seriesincolumn,&nbsp;titlesinfirstrow,&nbsp;titlesinfirstcolumn </PRE>

<!-- Arguments -->
<H4 class="dtH4">Arguments</H4>

<DL>
  <DT><I>object</I></DT>
  <DD>Required. A <A HREF="fcoobjchart.htm">Chart</A> object.</DD>

  <DT><I>filename</I></DT>
  <DD>Required. A string that specifies the name of the text file that contains the data.</DD>

  <DT><I>seriesincolumn</I></DT>
  <DD>Required. A boolean value that specifies whether data series are in columns or in rows.</DD>

  <DT><I>titlesinfirstrow</I></DT>
  <DD>Required. A boolean value that specifies whether the first data row should be interpreted as titles (i.e. series captions or categories names).</DD>

  <DT><I>titlesinfirstcolumn</I></DT>
  <DD>Required. A boolean value that specifies whether the first data column should be interpreted as titles (i.e. series captions or categories names).</DD>
</DL>

<!-- Remarks -->
<H4 class="dtH4">Remarks</H4>
<P>Before calling the <b>SetDataFromTxtFile</b> method, you must specify the separator characters used 
to delimit the data in the text file identified by <i>filename</i>. To specify the separator characters as well as separator rules, see the <a href="fcomthsetseparators.htm">SetSeparators method</a>.</P>

<P>If the text file identified by <i>filename</i> is in unicode, you must call the <a href="fcomthsetunicode.htm">SetUnicode</a> method to
specify that the <b>SetDataFromTxtFile</b> method should treat text files as a unicode (UTF-16).

<P>If both <I>titlesinfirstcolumn</I> and <I>titlesinfirstrow</I> are set to <b>true</b> then data located in the first cell (i.e. first column and first row) 
are interpreted as the <b>title</b> of the chart.</P>

<P>If the system fails to open the text file identified by <i>filename</i>, the <b>SetDataFromTxtFile</b> method raises an error.</P>

<!-- Parsing Rules -->
<H4 class="dtH4">Parsing Rules According to the Chart Type</H4>
<p>Swiff Chart Generator can produce various types of charts, either Column charts, Pie charts, Line charts or even XY-Scatter charts. 
The chart type is always specified in the Swiff Chart style file (.scs file, see <a href="../gsHowToCreateStyles.htm">How to Create Styles</a>
to learn more about styles). For this reason, data stored in a text file are not interpreted the
same way for all the chart types.</p>

<p>If the chart plot type is <i>Columns</i>, <i>Bars</i> or <i>Lines</i> then Swiff Chart Generator requires a set of 
individual series to display the chart. Therefore, the text data are parsed and interpreted as a set of 
individual series.</p> 

<p>However, if the chart plot type is XY-Scatter or XY-Curves then Swiff Chart Generator requires a set of 
series <b>pairs</b> to display the chart. Therefore, the text data are parsed and interpreted as a set of 
series <b>pairs</b> (first series for X values, second series for Y values). In this particular case, if the 
number of data series in the text file is odd, then the last data series are omitted.</p> 
<br>
<p>The following text file contains 2 series.</p>
<PRE class="code">Series1;12;7.5;11.3;9.2;5.3
Series2;14;9.9;13.1;11.5;4.9
</PRE>

<DL>
  <DT>If the chart type is <i>Columns</i>, <i>Bars</i> or <i>Lines</i></DT>
  <DD>Data are interpreted as 2 individual series of values (12, 7.5, 11.3, 9.2 and 5.3) and (14, 9.9, 13.1, 11.5 and 4.9).</DD>
  <DT>If the chart type is <i>XY-Scatter</i> or <i>XY-Curves</i></DT>
  <DD>Data are interpreted as a single series of XY Points (12,14), (7.5,9.9), (11.3,13.1), (9.2,11.5) and (5.3,4.9).</DD> 
</DL>

<!-- Sample Code -->
<H4 class="dtH4">VBScript Sample Code</H4>
<P>The following VBScript code sample illustrates use of the <b>SetDataFromTxtFile</b> method in an ASP page.</P>
<br>
<OL>
<LI><p>Here is a plain ASCII text file, named <b>data.txt</b> that contains the data we want to apply to the chart object.</p>
<PRE class="code">TitleOfMyChart;North&nbsp;America;South&nbsp;America;Europe;Middle&nbsp;East;Asia
Year 2006;12;7.5;11.3;9.2;5.3
Year 2007;14;9.9;13.1;11.5;4.9
</PRE>
<br>
</LI>

<LI><p>Before importing the text file, we must specify the separator characters and set some variables.</p>
<PRE class="code"><font color="#007700">'The text file has titles in columns as well as in rows</font>
<font color="#007700">'The  character ";" is the character separator in text file data.txt</font>
sep= ";"
ignoremultseparators= false

<font color="#007700">'Before going further we must specify the separators of the text file</font>
chart.SetSeparators sep, ignoremultseparators

<font color="#007700">'Let's load the graphical layout of the chart</font>
chart.LoadStyle "C:\myStyle.scs"

<font color="#007700">'the first text line contains the title and categories names: "TitleOfMyChart;North&nbsp;America;South&nbsp;America..."</font>
titlesinfirstrow= true

<font color="#007700">'the first text column contains the title and series captions: "TitleOfMyChart", "Year 2006" and "Year 2007"</font>
titlesinfirstcolumn= true
</PRE>
<br>
</LI>

<LI><P>Calling the <b>SetDataFromTxtFile</b> method with the parameters below...</p>
<PRE class="code">
seriesincolumns= <b>false</b>
chart.<b>SetDataFromTxtFile</b> "C:\data.txt", seriesincolumn, titlesinfirstrow, titlesinfirstcolumn</PRE>

<P>...leads to the following data stored in the chart object memory:</p>

<div class="tablediv"><table cellspacing="0" class="dtTable2">
    <tr>
      <td><font color=#FF0000><b>Title</b></font></td>
      <td colspan=6><b>MyChartTitle</b></td>
    </tr>
    <tr>
      <td><font color=#FF0000><b>Categories</b></font></td>
      <td>&nbsp;</td>
      <th>North&nbsp;America</th>
      <th>South&nbsp;America</th>
      <th>Europe</th>
      <th>Middle&nbsp;East</th>
      <th>Asia</th>
    </tr>
    <tr>
      <td><font color=#FF0000><b>Series 1</b></font></td>
      <td><b>Year 2006</b></td>
      <td>12</td>
      <td>7.5</td>
      <td>11.3</td>
      <td>9.2</td>
      <td>5.3</td>
    </tr>
    <tr>
      <td><font color=#FF0000><b>Series 2</b></font></td>
      <td><b>Year 2007</b></td>
      <td>14</td>
      <td>9.9</td>
      <td>13.1</td>
      <td>11.5</td>
      <td>4.9</td>
    </tr>
  </table></div>
<br>
</LI>

<LI><P>However, calling the <b>SetDataFromTxtFile</b> method with the parameters below...</p>
<PRE class="code">
seriesincolumns= <b>true</b>
chart.<b>SetDataFromTxtFile</b> "C:\data.txt", seriesincolumn, titlesinfirstrow, titlesinfirstcolumn</PRE>

<P>...leads to the following data stored in the chart object memory (maybe NOT what you would expect):</p>

<div class="tablediv"><table cellspacing="0" class="dtTable2">
    <tr>
      <td><font color=#FF0000><b>Title</b></font></td>
      <td colspan=3><b>MyChartTitle</b></td>
    </tr>
    <tr>
      <td><font color=#FF0000><b>Categories</b></font></td>
      <td>&nbsp;</th>
      <th>Year 2006</th>
      <th>Year 2007</th>
    </tr>
    <tr>
      <td><font color=#FF0000><b>Series 1</b></font></td>
      <td><b>North&nbsp;America</b></td>
      <td>12</td>
      <td>14</td>
    </tr>
    <tr>
      <td><font color=#FF0000><b>Series 2</b></font></td>
      <td><b>South&nbsp;America</b></td>
      <td>7.5</td>
      <td>9.9</td>
    </tr>
    <tr>
      <td><font color=#FF0000><b>Series 3</b></font></td>
      <td><b>Europe</b></td>
      <td>11.3</td>
      <td>13.1</td>
    </tr>
    <tr>
      <td><font color=#FF0000><b>Series 4</b></font></td>
      <td><b>Middle&nbsp;East</b></td>
      <td>9.2</td>
      <td>11.5</td>
    </tr>
    <tr>
      <td><font color=#FF0000><b>Series 5</b></font></td>
      <td><b>Asia</b></td>
      <td>5.3</td>
      <td>4.9</td>
    </tr>
  </table></div>
<br>
</LI>

</OL>

<!-- See Also  -->
<H4 class="dtH4">See Also</H4>

<P>
  <A HREF="fcomthsetdatafromquery.htm">SetDataFromQuery Method</A> |
  <A HREF="fcomthsetseparators.htm">SetSeparators Method</A> |
  <A HREF="fcomthsetunicode.htm">SetUnicode Method</A>
</P>

<!-- Applies to  -->
<P>Applies To: <A HREF="fcoobjchart.htm">Chart Object</A></P>

<SCRIPT LANGUAGE="JavaScript">
write_footer();
</SCRIPT>

</BODY>
</HTML>
